<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Screwed Time Intro</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      background: #000;
      width: 100vw;
      height: 100vh;
      overflow: hidden;
      display: flex;
      justify-content: center;
      align-items: center;
      /* Aë²„ì „: ì›ì´ ì¤„ì–´ë“¤ë©° ì‚¬ë¼ì§€ëŠ” íš¨ê³¼ */
      clip-path: circle(100% at 50% 50%);
      transition: clip-path 1s ease;
    }

    body.reveal-circle {
      clip-path: circle(0% at 50% 50%);
    }

    #container {
      width: 600px;
      height: 300px;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    #screws {
      width: 100%;
      height: auto;
    }

    #left, #right {
      transform-box: fill-box;     /* SVG ì•ˆì—ì„œ ê¸°ì¤€ */
      transform-origin: 50% 50%;   /* ì¤‘ì‹¬ íšŒì „ */
      transition: transform 0.02s linear;
    }

    /* C ë²„ì „ ë•Œ ì”Œìš¸ WebGL ìº”ë²„ìŠ¤ */
    #curlCanvas {
      position: fixed;
      inset: 0;
      width: 100vw;
      height: 100vh;
      display: none;           /* í•„ìš”í•  ë•Œë§Œ ë³´ì´ê²Œ */
      pointer-events: none;
      z-index: 10;
    }
  </style>
</head>
<body>
  <div id="container">
    <svg id="screws" viewBox="0 0 400 200">
      <!-- ì™¼ìª½ ë‚˜ì‚¬ -->
      <image href="screw.png" id="left" x="0" y="0" width="200" height="200" />
      <!-- ì˜¤ë¥¸ìª½ ë‚˜ì‚¬ -->
      <image href="screw.png" id="right" x="200" y="0" width="200" height="200" />
    </svg>
  </div>

  <!-- C ë²„ì „ìš© WebGL ìº”ë²„ìŠ¤ (ë‚˜ì¤‘ì— í™œì„±í™”) -->
  <canvas id="curlCanvas"></canvas>

  <script>
    // -----------------------------
    // ê³µí†µ: ë‚˜ì‚¬ ìë™ íšŒì „ + ë“œë˜ê·¸ íšŒì „
    // -----------------------------
    const left  = document.getElementById("left");
    const right = document.getElementById("right");

    let autoRotation = true;
    let angleLeft = 0;
    let angleRight = 0;

    function updateRotation() {
      left.style.transform  = `rotate(${angleLeft}deg)`;
      right.style.transform = `rotate(${angleRight}deg)`;
    }

    function rotateAuto() {
      if (autoRotation) {
        angleLeft  += 0.2;   // ì‹œê³„ ë°©í–¥
        angleRight -= 0.2;   // ë°˜ì‹œê³„ ë°©í–¥
        updateRotation();
      }
      requestAnimationFrame(rotateAuto);
    }
    rotateAuto();

    let dragging = false;
    let lastX = 0;
    let dragAccum = 0;  // ì–¼ë§ˆë‚˜ ë§ì´ ëŒë ¸ëŠ”ì§€ ì¶•ì 

    const activateThreshold = 500; // ì´ ê°’ ì´ìƒì´ë©´ í˜ì´ì§€ ì§„ì…

    document.addEventListener("mousedown", (e) => {
      dragging = true;
      autoRotation = false;
      lastX = e.clientX;
      dragAccum = 0;
    });

    document.addEventListener("mouseup", () => {
      dragging = false;
      autoRotation = true;

      if (Math.abs(dragAccum) > activateThreshold) {
        // ğŸ‘‰ ì—¬ê¸°ì„œ A ë²„ì „ or C ë²„ì „ ì¤‘ í•˜ë‚˜ í˜¸ì¶œ
        triggerPageRevealCircle();       // A ë²„ì „
        // triggerPageRevealCurl();     // C ë²„ì „ ì“°ê³ ì‹¶ìœ¼ë©´ ì´ ì¤„ë¡œ êµì²´
      }
    });

    document.addEventListener("mousemove", (e) => {
      if (!dragging) return;
      const delta = e.clientX - lastX;
      lastX = e.clientX;

      angleLeft  += delta * 0.7;
      angleRight -= delta * 0.7;
      dragAccum  += delta;

      updateRotation();
    });

    // -----------------------------
    // A ë²„ì „: clip-path ì› ìˆ˜ì¶• íš¨ê³¼
    // -----------------------------
    function triggerPageRevealCircle() {
      document.body.classList.add("reveal-circle");
      setTimeout(() => {
        window.location.href = "https://jisu1745.github.io/Screwed-Time/";
      }, 900);
    }

    // -----------------------------
    // C ë²„ì „: WebGL í˜ì´ì§€ ë§ë¦¼ íš¨ê³¼ (ì´ˆì•ˆ)
    // -----------------------------
    // ë‚˜ì¤‘ì— Three.js ë¡œì§ì„ ì—¬ê¸°ì„œ ì‹¤í–‰
    function triggerPageRevealCurl() {
      startCurlAnimation(() => {
        window.location.href = "https://jisu1745.github.io/Screwed-Time/";
      });
    }
  </script>

  <!-- C ë²„ì „ìš© Three.js (í•„ìš”í•  ë•Œë§Œ ì‚¬ìš©) -->
  <!-- <script src="https://unpkg.com/three@0.160.0/build/three.min.js"></script>
  <script src="curl.js"></script> -->
</body>
</html>
